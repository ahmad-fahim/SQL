SELECT DDPOPAYDB_ADVICE_REC_DATE, SUM(ADVICE_RECIVE_AMOUNT) ADVICE_RECIVE_AMOUNT,SUM(ADVICE_PAY_AMOUNT) ADVICE_PAY_AMOUNT,
SUM(NUMBER_OF_INSTRUMENT_RECIVE) NUMBER_OF_INSTRUMENT_RECIVE,SUM(NUMBER_OF_INSTRUMENT_PAY) NUMBER_OF_INSTRUMENT_PAY
FROM (
SELECT DDPOPAYDB_ADVICE_REC_DATE,SUM(NVL(DDPOPAYDB_INST_AMT,0)) ADVICE_RECIVE_AMOUNT,0 ADVICE_PAY_AMOUNT, COUNT(*) NUMBER_OF_INSTRUMENT_RECIVE,0 NUMBER_OF_INSTRUMENT_PAY
FROM DDPOPAYDB
WHERE DDPOPAYDB_ISSUED_ON_BNK=200 AND DDPOPAYDB_STATUS NOT IN ('C','R','E')
AND DDPOPAYDB_ISSUED_ON_BRN=:P_BRANCH_CODE ---AND DDPOPAYDB_ISSUED_BRN<>16055
 AND DDPOPAYDB_REMIT_CODE IN ('2','9')
GROUP BY DDPOPAYDB_ADVICE_REC_DATE
UNION ALL
SELECT DDPOPAY_PAY_DATE DDPOPAYDB_ADVICE_REC_DATE,0 CREDIT, SUM(DDPOPAY_INST_AMT) DEBIT, 0 NUMBER_OF_INSTRUMENT_RECIVE,COUNT(*) NUMBER_OF_INSTRUMENT_PAY
FROM (SELECT  A.DDPOPAY_PAY_DATE, A.DDPOPAY_INST_AMT, A.DDPOPAY_INST_NUM, A.DDPOPAY_INST_PFX
FROM DDPOPAY A, DDPOPAYDB B
WHERE A.DDPOPAY_INST_NUM=B.DDPOPAYDB_LEAF_NUM
AND A.DDPOPAY_INST_PFX=B.DDPOPAYDB_INST_PFX
AND NVL(DDPOPAYDB_STATUS,'#')  NOT IN ('C','R','E')
AND DDPOPAY_REMIT_CODE  IN ('2','9')
AND DDPOPAY_BRN_CODE=:P_BRANCH_CODE)
GROUP BY DDPOPAY_PAY_DATE)
GROUP BY DDPOPAYDB_ADVICE_REC_DATE
ORDER BY DDPOPAYDB_ADVICE_REC_DATE
