BEGIN
FOR IND IN (SELECT DDADVPARTDTL_ADV_REC_DATE,DD.ROWID DATA_ROW, DDADVPARTDTL_ENTITY_NUM||DDADVPARTDTL_BRN_CODE||DDADVPARTDTL_ADVICE_NO||DDADVPARTDTL_ADVICE_DATE||DDADVPARTDTL_ISSUE_BRN_CODE||DDADVPARTDTL_ADV_REC_DATE||DDADVPARTDTL_LEAF_PFX||DDADVPARTDTL_LEAF_NUMBER KEY_DATA
FROM DDADVPARTDTL DA, DDPOPAYDB DD
WHERE DA.DDADVPARTDTL_REM_CODE=DD.DDPOPAYDB_REMIT_CODE
AND DA.DDADVPARTDTL_LEAF_NUMBER=DD.DDPOPAYDB_LEAF_NUM
AND DA.DDADVPARTDTL_ISSUE_BRN_CODE=DD.DDPOPAYDB_ISSUED_BRN
AND DA.DDADVPARTDTL_BRN_CODE=TO_NUMBER(DDPOPAYDB_ISSUED_ON_BRN)
AND DA.DDADVPARTDTL_INST_AMT=DD.DDPOPAYDB_INST_AMT
AND DA.DDADVPARTDTL_ADVICE_DATE=DD.DDPOPAYDB_ADVICE_DATE
AND DA.DDADVPARTDTL_INST_DATE=DD.DDPOPAYDB_INST_DATE
AND DA.DDADVPARTDTL_LEAF_PFX=DD.DDPOPAYDB_INST_PFX
AND DDPOPAYDB_ADVICE_REC_DATE IS NULL
AND DDPOPAYDB_ISSUED_ON_BRN = '41137')
LOOP

UPDATE DDPOPAYDB
SET DDPOPAYDB_ADVICE_REC_DATE=IND.DDADVPARTDTL_ADV_REC_DATE
WHERE ROWID=IND.DATA_ROW; --DDADVPARTDTL_ENTITY_NUM||DDADVPARTDTL_BRN_CODE||DDADVPARTDTL_ADVICE_NO||DDADVPARTDTL_ADVICE_DATE||DDADVPARTDTL_ISSUE_BRN_CODE||DDADVPARTDTL_ADV_REC_DATE||DDADVPARTDTL_LEAF_PFX||DDADVPARTDTL_LEAF_NUMBER=IND.KEY_DATA;

END LOOP;
END;





BEGIN
     FOR IDX IN (SELECT D.DDPOPAYDB_INST_PFX,
                        D.DDPOPAYDB_LEAF_NUM,
                        DA.DDADVPARTDTL_ADV_REC_DATE
                   FROM DDPOPAYDB D, DDADVPARTDTL DA
                  WHERE D.DDPOPAYDB_REMIT_CODE = DA.DDADVPARTDTL_REM_CODE
                    AND D.DDPOPAYDB_INST_PFX = DA.DDADVPARTDTL_LEAF_PFX
                    AND D.DDPOPAYDB_LEAF_NUM = DA.DDADVPARTDTL_LEAF_NUMBER
                    AND D.DDPOPAYDB_ISSUED_ON_BRN = P_BRANCH_CODE
                    AND DA.DDADVPARTDTL_BRN_CODE = P_BRANCH_CODE
                    AND D.DDPOPAYDB_ADVICE_REC_DATE IS NULL
                    AND D.DDPOPAYDB_ISSUED_ON_BRN = DA.DDADVPARTDTL_BRN_CODE) LOOP
       UPDATE DDPOPAYDB DD
          SET DD.DDPOPAYDB_ADVICE_REC_DATE = IDX.DDADVPARTDTL_ADV_REC_DATE
        WHERE DD.DDPOPAYDB_INST_PFX = IDX.DDPOPAYDB_INST_PFX
          AND DD.DDPOPAYDB_LEAF_NUM = IDX.DDPOPAYDB_LEAF_NUM;
     END LOOP;
   END;