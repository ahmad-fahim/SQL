SELECT  DDPOISSDTL_BRN_CODE,DDPOISSDTL_REMIT_CODE,DDPOISSDTL_ISSUE_DATE,DDPOISSDTL_DAY_SL,DDPOISSDTL_INST_SL,DDPOISSDTL_INST_NUM_PFX,
         DDPOPAYDB_DUP_INST_LEAF_NUM,DDPOISS_INST_CURRENCY,DDPOISSDTL_INST_AMT,DDPOISSDTL_BENEF_NAME1, DDPOISSDTL_BENEF_NAME2,DDPOISS_PUR_MODE,
         DDPOPAYDB_STATUS,DDPOPAYDB_PAY_CAN_DUP_DATE,DDPODUPISS_ISSUE_DATE,DDPOISSDTL_INST_NUM,'''' as DDPODUPISS_RESPONDING_DATE ,
         DDPOPAYDB_ADVICE_DATE,DDPOPAYDB_ADVICE_REC_DATE
FROM   (SELECT DDPOISSDTL_BRN_CODE,
               DDPOISSDTL_REMIT_CODE,
               DDPOISSDTL_ISSUE_DATE,
               DDPOISSDTL_DAY_SL,
               DDPOISSDTL_INST_SL,
               DDPOISSDTL_INST_AMT,
               DDPOISSDTL_INST_NUM_PFX,
               DDPOISSDTL_INST_NUM,
               DDPOISS_PUR_NAME,
               DDPOISS_PUR_MODE,
               DDPOISS_INST_CURRENCY,
               SUBSTR(DDPOISSDTL_BENEF_NAME1, 1, 50)
               DDPOISSDTL_BENEF_NAME1,
               SUBSTR(DDPOISSDTL_BENEF_NAME2, 1, 50)
               DDPOISSDTL_BENEF_NAME2,
               TO_CHAR(DDPODUPISS_ISSUE_DATE, 'DD-MON-YYYY')
               DDPODUPISS_ISSUE_DATE
        FROM   DDPOISS,
               DDPOISSDTL
               LEFT JOIN DDPODUPISS
                      ON (DDPODUPISS_BRN_CODE = DDPOISSDTL_BRN_CODE
                         AND DDPODUPISS_REMIT_CODE = DDPOISSDTL_REMIT_CODE
                         AND DDPODUPISS_ORIGINAL_LEAF_NUM = DDPOISSDTL_INST_NUM   and DDPODUPISS_DUPISS_DATE = DDPOISSDTL_ISSUE_DATE
                         and DDPODUPISS_DAY_SL=DDPOISSDTL_DAY_SL )
        WHERE  DDPOISSDTL_ENTITY_NUM = 1
               AND DDPOISS_ENTITY_NUM = 1
               AND DDPOISSDTL_BRN_CODE = DDPOISS_BRN_CODE
               AND DDPOISSDTL_REMIT_CODE = DDPOISS_REMIT_CODE
               AND DDPOISSDTL_ISSUE_DATE = DDPOISS_ISSUE_DATE
               AND DDPOISSDTL_DAY_SL = DDPOISS_DAY_SL
               AND DDPOISS_REJ_ON IS NULL
               AND DDPOISSDTL_BRN_CODE = :1
               AND DDPOISSDTL_REMIT_CODE= :2
               AND DDPOISSDTL_ISSUE_DATE BETWEEN :3 AND :4
               ) DD
       INNER JOIN DDPOPAYDB
               ON ( DDPOPAYDB_REMIT_CODE = DDPOISSDTL_REMIT_CODE
                    AND DDPOPAYDB_INST_PFX = DDPOISSDTL_INST_NUM_PFX
                    AND DDPOPAYDB_LEAF_NUM = DDPOISSDTL_INST_NUM
                    AND DDPOPAYDB_INST_AMT = DDPOISSDTL_INST_AMT
                    AND DDPOPAYDB_ISSUED_BRN = DDPOISSDTL_BRN_CODE ) 
                    WHERE  DDPOISSDTL_INST_NUM IS NOT NULL  and (DDPOPAYDB_STATUS is null   or  DDPOPAYDB_STATUS =' ' or DDPOPAYDB_STATUS='P' or DDPOPAYDB_STATUS='C')
           and (DDPOPAYDB_PAY_CAN_DUP_DATE is null  
            or DDPOPAYDB_PAY_CAN_DUP_DATE >= :5)
            ORDER BY DDPOISSDTL_ISSUE_DATE,DDPOISSDTL_INST_NUM 